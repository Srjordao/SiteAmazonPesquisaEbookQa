name: Testes Selenium com Coverage

on:
  push:
    branches:
      - main  # Altere para a branch em que deseja executar os testes
  pull_request:
    branches:
      - main

# Agendamento para executar nos horários específicos
schedule:
  - cron: "0 9,11,15,18 * * 1-5"  # Executar às 9h, 11h, 15h e 18h UTC de segunda a sexta-feira

jobs:
  test:
    runs-on: ubuntu-latest

    steps:
      - name: Checkout do código
        uses: actions/checkout@v2

      - name: Configurar ambiente Python
        uses: actions/setup-python@v2
        with:
          python-version: 3.x  # Altere para a versão do Python que você está usando

      - name: Instalar dependências
        run: |
          python -m pip install --upgrade pip
          pip install selenium
          pip install webdriver_manager
<<<<<<< HEAD
=======
          pip install pytest
          pip install pytest-html
          pip install coverage
>>>>>>> b680929fa1cc333c9c466693cc142b2c4246819d

      - name: Instalar o ChromeDriver
        run: |
          LATEST_CHROMEDRIVER_VERSION=$(curl -sS chromedriver.storage.googleapis.com/LATEST_RELEASE)
          curl -sS -o chromedriver.zip https://chromedriver.storage.googleapis.com/$LATEST_CHROMEDRIVER_VERSION/chromedriver_linux64.zip
          unzip chromedriver.zip
          chmod +x chromedriver
          sudo mv chromedriver /usr/local/bin/

      - name: Executar testes
<<<<<<< HEAD
        run: python tests/test_amazon.py
=======
        run: |
          pytest --html=report.html

      - name: Gerar relatório de cobertura
        run: |
          coverage run -m pytest
          coverage report

      - name: Publicar relatório de cobertura
        uses: actions/upload-artifact@v2
        with:
          name: Cobertura-Report
          path: htmlcov

      - name: Publicar relatório de testes
        uses: actions/upload-artifact@v2
        with:
          name: Test-Reports
          path: report.html
>>>>>>> b680929fa1cc333c9c466693cc142b2c4246819d
